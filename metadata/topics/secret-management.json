{
  "id": "secret-management",
  "slug": "secret-management",
  "title": "Secret Management",
  "phase": "03-development",
  "phase_name": "Development",
  "order_in_phase": 4,

  "description": {
    "short": "Safely handle API keys, passwords, and credentials",
    "medium": "Never commit secrets to version control, use environment variables as baseline, graduate to secret management services, implement rotation, and respond to secret exposure",
    "full": "Secret management covers handling sensitive data like API keys, passwords, database credentials, encryption keys, and tokens. This includes never committing secrets to git, using environment variables properly, secret management services (AWS Secrets Manager, HashiCorp Vault, Azure Key Vault), secret rotation strategies, least privilege access, detection and response to exposure, and compliance requirements."
  },

  "why_it_matters": [
    "Exposed secrets lead to data breaches and financial loss",
    "Hardcoded credentials are the #1 preventable security mistake",
    "Secret rotation limits damage from compromised credentials",
    "Compliance requires proper secret handling (PCI-DSS, HIPAA, SOC 2)",
    "Poor secret management breaks trust with customers"
  ],

  "depth_levels": {
    "surface": {
      "reading_time_minutes": 8,
      "difficulty": "beginner",
      "objectives": [
        "Never commit secrets to version control",
        "Use environment variables for local development",
        "Know what to do if you accidentally commit a secret"
      ],
      "key_takeaways": [
        "Add .env to .gitignore immediately",
        "Use environment variables as baseline protection",
        "If you commit a secret, revoke it immediately",
        "Different secrets for dev, staging, production"
      ]
    },
    "mid-depth": {
      "reading_time_minutes": 25,
      "difficulty": "intermediate",
      "objectives": [
        "Choose appropriate secret management service",
        "Implement secret rotation",
        "Set up secret scanning in CI/CD",
        "Apply least privilege to secret access"
      ],
      "key_takeaways": [
        "Environment variables work for small projects, graduate to secret managers for production",
        "Automated rotation reduces impact of compromised secrets",
        "Scan commits for secrets with tools like GitGuardian or TruffleHog",
        "Scope secrets to the minimum necessary (per-service, per-environment)"
      ]
    },
    "deep-water": {
      "reading_time_minutes": 45,
      "difficulty": "advanced",
      "objectives": [
        "Design secret management architecture for microservices",
        "Implement dynamic secret generation with Vault",
        "Manage encryption keys with HSM or KMS",
        "Build compliance-ready audit trails"
      ],
      "key_takeaways": [
        "Dynamic secrets (short-lived credentials) limit exposure window",
        "Kubernetes secret management requires External Secrets Operator or Vault",
        "Encryption key hierarchy (KEK/DEK) separates key management from data",
        "Zero-trust requires identity-based access with short-lived tokens"
      ]
    }
  },

  "prerequisites": [],

  "related_topics": [
    "secure-coding-practices",
    "supply-chain-security",
    "deployment-strategy",
    "incident-response"
  ],

  "personas": [
    "new-developer",
    "yolo-dev",
    "generalist-leveling-up",
    "specialist-expanding",
    "busy-developer"
  ],

  "tools": [
    "AWS Secrets Manager",
    "HashiCorp Vault",
    "Azure Key Vault",
    "Google Cloud Secret Manager",
    "1Password",
    "LastPass",
    "GitGuardian",
    "TruffleHog",
    "git-secrets",
    "External Secrets Operator",
    "Sealed Secrets",
    "SOPS"
  ],

  "frameworks_and_concepts": [
    "Environment variables",
    "Secret rotation",
    "Least privilege",
    "Dynamic secrets",
    "Encryption key management (KEK/DEK)",
    "Zero-trust access",
    "OIDC for keyless authentication",
    "Envelope encryption"
  ],

  "compliance_relevance": [
    "PCI-DSS (secure credential storage, rotation)",
    "HIPAA (encryption key management, access controls)",
    "SOC 2 (secret access auditing)",
    "GDPR (encryption requirements)",
    "ISO 27001 (cryptographic controls)"
  ],

  "estimated_time_to_implement": {
    "surface": "Immediate - use environment variables today",
    "mid_depth": "1-2 weeks to set up secret manager and scanning",
    "deep_water": "2-6 months for enterprise secret architecture with Vault"
  },

  "common_mistakes": [
    "Committing .env files to git",
    "Hardcoding secrets in source code",
    "Sending secrets via email or Slack",
    "Using production secrets in development",
    "Never rotating secrets",
    "Logging secrets in application logs",
    "Storing secrets in Docker images",
    "Passing secrets in URLs"
  ],

  "success_metrics": [
    "Zero secrets in version control (verified by scanning)",
    "Secret rotation frequency (30-90 days for critical secrets)",
    "Time to revoke compromised secret (< 1 hour)",
    "Audit coverage (all secret access logged)",
    "Secret sprawl (number of places secrets are stored)"
  ],

  "when_to_prioritize": [
    "Building production systems with sensitive data",
    "Compliance-regulated industries (healthcare, finance)",
    "After any secret exposure incident",
    "Microservices with many service-to-service calls",
    "CI/CD pipelines accessing production"
  ],

  "when_to_deprioritize": [
    "Local development tools with no sensitive data",
    "Offline applications with no network access",
    "Completely air-gapped systems"
  ]
}
